<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournament Management</title>

    <link rel="stylesheet" href="/static/styles/tournament_management.css">
    <link rel="stylesheet" href="/static/styles/tournament_global.css">
</head>
<body>
    <div class="management-container silver-shine">
        <a href="/mainmenu" class="back-button">Back</a>
        
        <h2>Tournament Management</h2>
        <!-- Add Tournament Form -->
        <form action="/tournament/add_tournament" method="POST">
            <div class="form-group">
                <label for="tournament_name">Tournament Name:</label>
                <input type="text" id="tournament_name" name="tournament_name" required>
            </div>

            <div class="form-group">
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" required>
            </div>

            <div class="form-group">
                <label for="start_time">Start Time:</label>
                <input type="time" id="start_time" name="start_time" required>
            </div>

            <div class="form-group">
                <label for="end_time">End Time:</label>
                <input type="time" id="end_time" name="end_time" required>
            </div>

            <div class="form-group">
                <label for="location">Location:</label>
                <input type="text" id="location" name="location" required>
            </div>
            <div class="form-group">
                <label for="tournament_type">Tournament Type:</label>
                <select id="tournament_type" name="tournament_type" required>
                    <option value="Single Elimination">Single Elimination</option>
                    <option value="Round Robin">Round Robin</option>
                </select>
            </div>

            <div class="form-group">
                <label for="team_based" class="team_inputs">Team-Based Tournament:</label>
                <input type="checkbox" id="team_based" class="team_inputs" name="team_based" value="TRUE">
                <span>Check if this tournament will be team-based.</span>
            </div>
            <button type="submit" class="submit-button">Add Tournament</button>
        </form>
        <hr class="subtle-line">
        <!-- Tournament List -->
        <h3>Current Tournaments</h3>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Date</th>
                    <th>Start</th>
                    <th>End</th>
                    <th>Type</th>
                    <th>Location</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% if tournaments %}
                    {% for tournament in tournaments %}
                    <tr onclick="redirectToRegister({{ tournament.id }})">
                        <td>{{ tournament.name }}</td>
                        <td>{{ tournament.date }}</td>
                        <td>{{ tournament.start_time }}</td>
                        <td>{{ tournament.end_time }}</td>
                        <td>{{ tournament.type }}</td>
                        <td>{{ tournament.location }}</td>
                        <td>
                            {% if tournament.matches | length == 0 %}
                                <form action="/create_{{ tournament.type | lower | replace(' ', '_') }}_bracket?tournament_id={{ tournament.id }}"  method="POST">
                                    <button type="submit" class="action-btn start-btn">Start</button>
                                </form>
                            {% else %}
                                <form action="/reset_matches/{{ tournament.id }}" method="POST">
                                    <button type="submit" class="action-btn reset-btn">Reset</button>
                                </form>
                            {% endif %}
                            <form action="/remove_tournament/{{ tournament.id }}" method="POST" onsubmit="return confirm('Are you sure you want to permanently delete this tournament?');">
                                <button type="submit" class="action-btn delete-btn">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>
    <a href="/tournament" class="btn logout-button">
        <img src="/static/images/USU_Logo.png" alt="USU Logo" class="usu-logo">
    </a>
    <script src="/static/scripts/tournament_management.js"></script>
</body>
</html>